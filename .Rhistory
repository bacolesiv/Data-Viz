mydata.c <- mydata.c %>%
mutate(popularity.cat = factor(popularity.cat, levels = centrality.levels, ordered = T))
popularity.weapon <- mydata.c %>%
ggplot(aes(x = popularity.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
coord_flip() +
labs(title = "Weapon Carrying by Popularity", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), legend.position = "none")
(a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2))
density <- quantile(mydata.c$density, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(density.cat = case_when(
density <= 15.7 ~ "0:10th Percentile",
(density > 15.7 & density <= 26.2) ~ "10th:50th Percentile",
(density > 26.2 & density <= 50) ~ "50th:90th Percentile",
density > 50 ~ ">90th Percentile",
T ~ NA_character_))
density.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(density.cat = factor(density.cat, levels = density.levels, ordered = T))
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
coord_flip() +
labs(title = "Weapon Carrying by Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
centrality <- quantile(mydata.c$centrality, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(centrality.cat = case_when(
centrality == 0 ~ "0:10th Percentile",
(centrality > 0 & centrality <= 0.787) ~ "10th:50th Percentile",
(centrality > 0.787 & centrality <= 1.702) ~ "50th:90th Percentile",
centrality > 1.702 ~ ">90th Percentile",
T ~ NA_character_))
centrality.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(centrality.cat = factor(centrality.cat, levels = centrality.levels, ordered = T))
centrality.weapon <- mydata.c %>%
ggplot(aes(x = centrality.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
coord_flip() +
labs(title = "Weapon Carrying by Centrality", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
popularity <- quantile(mydata.c$popularity, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(popularity.cat = case_when(
popularity <= 1 ~ "0:10th Percentile",
(popularity > 1 & popularity <= 4) ~ "10th:50th Percentile",
(popularity > 4 & popularity <= 10) ~ "50th:90th Percentile",
popularity > 10 ~ ">90th Percentile",
T ~ NA_character_))
popularity <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(popularity.cat = factor(popularity.cat, levels = centrality.levels, ordered = T))
popularity.weapon <- mydata.c %>%
ggplot(aes(x = popularity.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
coord_flip() +
labs(title = "Weapon Carrying by Popularity", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
centrality.weapon
popularity.weapon
density.weapon
(a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2))
density <- quantile(mydata.c$density, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(density.cat = case_when(
density <= 15.7 ~ "0:10th Percentile",
(density > 15.7 & density <= 26.2) ~ "10th:50th Percentile",
(density > 26.2 & density <= 50) ~ "50th:90th Percentile",
density > 50 ~ ">90th Percentile",
T ~ NA_character_))
density.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(density.cat = factor(density.cat, levels = density.levels, ordered = T))
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
centrality <- quantile(mydata.c$centrality, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(centrality.cat = case_when(
centrality == 0 ~ "0:10th Percentile",
(centrality > 0 & centrality <= 0.787) ~ "10th:50th Percentile",
(centrality > 0.787 & centrality <= 1.702) ~ "50th:90th Percentile",
centrality > 1.702 ~ ">90th Percentile",
T ~ NA_character_))
centrality.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(centrality.cat = factor(centrality.cat, levels = centrality.levels, ordered = T))
centrality.weapon <- mydata.c %>%
ggplot(aes(x = centrality.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
coord_flip() +
labs(title = "Centrality", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
popularity <- quantile(mydata.c$popularity, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(popularity.cat = case_when(
popularity <= 1 ~ "0:10th Percentile",
(popularity > 1 & popularity <= 4) ~ "10th:50th Percentile",
(popularity > 4 & popularity <= 10) ~ "50th:90th Percentile",
popularity > 10 ~ ">90th Percentile",
T ~ NA_character_))
popularity <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(popularity.cat = factor(popularity.cat, levels = centrality.levels, ordered = T))
popularity.weapon <- mydata.c %>%
ggplot(aes(x = popularity.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
coord_flip() +
labs(title = "Popularity", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
(a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2), top = "Weapon Carrying")
(a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2, top = "Weapon Carrying")
(a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2, top = "Weapon Carrying")
(a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2, top = "Weapon Carrying"))
(a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2, top = "Weapon Carrying"))
a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2, top = "Weapon Carrying")
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2, top = "Weapon Carrying")
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
centrality.weapon
popularity.weapon
density.weapon
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate(text, x = .052, y = 3, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = .052, y = 3, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = .052, y = "50th:90th Percentile", label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = .052, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = .052, y = .1, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3, y = 0.52, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3, y = 0.52, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = .1, y = 0.52, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 1, y = 0.52, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3, y = 0.052, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3, y = 0.06, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.06, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.065, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.063, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
density.weapon
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2) %>% ggsave("weapons_plot.pdf", width = 20, height = 15, units = "cm")
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2) %>% ggsave("weapons_plot.pdf", width = 20, height = 15, units = "cm")
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
ggsave("weapons_plot.pdf", width = 20, height = 15, units = "cm")
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
ggsave("weapons_plot.pdf", width = 20, height = 15, units = "cm")
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2) %>%
ggsave("weapons_plot.pdf", width = 20, height = 15, units = "cm")
grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2) +
ggsave("weapons_plot.pdf", width = 20, height = 15, units = "cm")
a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
a
ggsave("weapons_plot.pdf", width = 20, height = 15, units = "cm")
centrality.weapon
popularity.weapon
density.weapon
a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
ggsave("weapons_plot.pdf", a, width = 20, height = 15, units = "cm")
ggsave("weapons_plot.pdf", a, width = 30, height = 15, units = "cm")
ggsave("weapons_plot.pdf", a, width = 25, height = 15, units = "cm")
density <- quantile(mydata.c$density, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(density.cat = case_when(
density <= 15.7 ~ "0:10th Percentile",
(density > 15.7 & density <= 26.2) ~ "10th:50th Percentile",
(density > 26.2 & density <= 50) ~ "50th:90th Percentile",
density > 50 ~ ">90th Percentile",
T ~ NA_character_))
density.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(density.cat = factor(density.cat, levels = density.levels, ordered = T))
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.063, label = "Sample Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
centrality <- quantile(mydata.c$centrality, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(centrality.cat = case_when(
centrality == 0 ~ "0:10th Percentile",
(centrality > 0 & centrality <= 0.787) ~ "10th:50th Percentile",
(centrality > 0.787 & centrality <= 1.702) ~ "50th:90th Percentile",
centrality > 1.702 ~ ">90th Percentile",
T ~ NA_character_))
centrality.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(centrality.cat = factor(centrality.cat, levels = centrality.levels, ordered = T))
centrality.weapon <- mydata.c %>%
ggplot(aes(x = centrality.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.063, label = "Sample Mean", color = "darkred") +
coord_flip() +
labs(title = "Centrality", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
popularity <- quantile(mydata.c$popularity, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(popularity.cat = case_when(
popularity <= 1 ~ "0:10th Percentile",
(popularity > 1 & popularity <= 4) ~ "10th:50th Percentile",
(popularity > 4 & popularity <= 10) ~ "50th:90th Percentile",
popularity > 10 ~ ">90th Percentile",
T ~ NA_character_))
popularity <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(popularity.cat = factor(popularity.cat, levels = centrality.levels, ordered = T))
popularity.weapon <- mydata.c %>%
ggplot(aes(x = popularity.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.063, label = "Sample Mean", color = "darkred") +
coord_flip() +
labs(title = "Popularity", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
centrality.weapon
popularity.weapon
density.weapon
a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
ggsave("weapons_plot.pdf", a, width = 25, height = 15, units = "cm")
density <- quantile(mydata.c$density, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(density.cat = case_when(
density <= 15.7 ~ "0:10th Percentile",
(density > 15.7 & density <= 26.2) ~ "10th:50th Percentile",
(density > 26.2 & density <= 50) ~ "50th:90th Percentile",
density > 50 ~ ">90th Percentile",
T ~ NA_character_))
density.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(density.cat = factor(density.cat, levels = density.levels, ordered = T))
density.weapon <- mydata.c %>%
ggplot(aes(x = density.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.063, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Density", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
centrality <- quantile(mydata.c$centrality, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(centrality.cat = case_when(
centrality == 0 ~ "0:10th Percentile",
(centrality > 0 & centrality <= 0.787) ~ "10th:50th Percentile",
(centrality > 0.787 & centrality <= 1.702) ~ "50th:90th Percentile",
centrality > 1.702 ~ ">90th Percentile",
T ~ NA_character_))
centrality.levels <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(centrality.cat = factor(centrality.cat, levels = centrality.levels, ordered = T))
centrality.weapon <- mydata.c %>%
ggplot(aes(x = centrality.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.063, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Centrality", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
popularity <- quantile(mydata.c$popularity, c(.1, .5, .9))
mydata.c <- mydata.c %>%
mutate(popularity.cat = case_when(
popularity <= 1 ~ "0:10th Percentile",
(popularity > 1 & popularity <= 4) ~ "10th:50th Percentile",
(popularity > 4 & popularity <= 10) ~ "50th:90th Percentile",
popularity > 10 ~ ">90th Percentile",
T ~ NA_character_))
popularity <- c("0:10th Percentile", "10th:50th Percentile", "50th:90th Percentile", ">90th Percentile")
mydata.c <- mydata.c %>%
mutate(popularity.cat = factor(popularity.cat, levels = centrality.levels, ordered = T))
popularity.weapon <- mydata.c %>%
ggplot(aes(x = popularity.cat)) +
geom_bar(aes(fill = as.character(weapon.carry)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mean(mydata.c$weapon.carry), linetype = "dashed", color = "darkred") + #can use annotate() to label the mean line?
ylim(0, .1) +
annotate("text", x = 3.2, y = 0.063, label = "Mean", color = "darkred") +
coord_flip() +
labs(title = "Popularity", y = "Proportion of Weapon Carriers", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
centrality.weapon
popularity.weapon
density.weapon
a <- grid.arrange(centrality.weapon, popularity.weapon, density.weapon, nrow = 2, ncol = 2)
ggsave("weapons_plot.pdf", a, width = 25, height = 15, units = "cm")
