theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.title =  = "Victimization"))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.195, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
theme_igray() +
scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.title = "Victimization"))
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.title = element_text(Victimization))
theme_igray() +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.195, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
theme_igray() +
scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.title = element_text(Victimization)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.195, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
theme_igray() +
scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.title = element_text("Victimization")))
rh.victim
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
theme_igray() +
scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)) +
scale_fill_discrete(name="Victimization"))
scale_fill_pander() +
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_discrete(name="Victimization") +
theme_igray() +
scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_discrete(name="Victimization") +
theme_igray() +
#scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_discrete(name="Victimization") +
#theme_igray() +
#scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "chartreuse4"),
name="Victimization",
breaks=c("0", "1"),
labels=c("Non Victim", "Victim")) +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("0", "1"),
labels=c("Non Victim", "Victim")) +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("0", "1"),
labels=c("Victim", "Non Victim")) +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.factor(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ")
rh.victim
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("0", "1"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("0", "1"),
labels=c("Non Victim", "Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("red3", "green4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed", color = "red3") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", color = "red3", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("green4", "red3"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("green4", "red3"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
#ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("green4", "red3"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .5) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("green4", "red3"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
#ylim(0, .5) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("green4", "red3"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victim", "Non Victim")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("chartruese4"),
name="Victimization",
breaks=c("1"),
labels=c("Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("chartruese4", "white"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("chartreuse4", "white"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "chartruese4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.3, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "chartreuse4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.19, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "chartreuse4"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .25) +
annotate("text", x = 1, y = 0.19, label = "Mean\nVictimization", size = 3.5) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "seagreen"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .23) +
annotate("text", x = 1, y = 0.19, label = "Mean\nVictimization", size = 3) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "seagreen"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .22) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", size = 3) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "seagreen"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
racial.heterogeneity <- quantile(mydata.c$racial.heterogeneity, c(.33, .66))
mydata.c <- mydata.c %>%
mutate(rh.cat = case_when(
racial.heterogeneity <= .33 ~ "Low", #Bottom 1/3
(racial.heterogeneity > .33 & racial.heterogeneity <= .66) ~ "Middle", #Between 1/3 and 2/3
racial.heterogeneity > .66 ~ "High", #Top 1/3
T ~ NA_character_))
racial.heterogeneity.levels <- c("Low", "Middle", "High")
mydata.c <- mydata.c %>%
mutate(rh.cat = factor(rh.cat, levels = racial.heterogeneity.levels, ordered = T))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .22) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", size = 3) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "seagreen"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
ggsave("rh.victim.pdf", rh.victim, width = 25, height = 15, units = "cm")
network.delinquency <- quantile(mydata.c$network.delinquency, c(.5))
mydata.c <- mydata.c %>%
mutate(Delinquency = case_when(
network.delinquency <= .7143 ~ "Non Delinquents", #At or Below the 25th Percentile
(network.delinquency > .7143 & network.delinquency < 1.4286) ~ "Average Teen", #IQR
network.delinquency >= 1.4286 ~ "Delinquents", #At or Above the 75th Percentile
T ~ NA_character_))
(rh.delinquency <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = Delinquency), position = "fill") +
coord_flip() +
labs(title = "Racial Heterogeneity & Delinquency", y = "Proportion of Delinquents", x = " ") +
theme_igray() +
scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
ggsave("rh.delinquency.pdf", rh.delinquency, width = 25, height = 15, units = "cm")
a <- grid.arrange(rh.victim, rh.delinquency, nrow = 2)
ggsave("rh.pdf", a, width = 25, height = 15, units = "cm")
racial.heterogeneity <- quantile(mydata.c$racial.heterogeneity, c(.33, .66))
mydata.c <- mydata.c %>%
mutate(rh.cat = case_when(
racial.heterogeneity <= .33 ~ "Low", #Bottom 1/3
(racial.heterogeneity > .33 & racial.heterogeneity <= .66) ~ "Middle", #Between 1/3 and 2/3
racial.heterogeneity > .66 ~ "High", #Top 1/3
T ~ NA_character_))
racial.heterogeneity.levels <- c("Low", "Middle", "High")
mydata.c <- mydata.c %>%
mutate(rh.cat = factor(rh.cat, levels = racial.heterogeneity.levels, ordered = T))
(rh.victim <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") +
geom_hline(yintercept= mean(mydata.c$victim), linetype = "dashed") +
ylim(0, .22) +
annotate("text", x = 1, y = 0.2, label = "Mean\nVictimization", size = 3) +
coord_flip() +
labs(title = "Racial Heterogeneity & Victimization", y = "Proportion of Victims", x = " ") +
scale_fill_manual(values=c("white", "seagreen"),
name="Victimization",
breaks=c("1", "0"),
labels=c("Victims", "Non-Victims")) +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
ggsave("rh.victim.pdf", rh.victim, width = 25, height = 15, units = "cm")
network.delinquency <- quantile(mydata.c$network.delinquency, c(.5))
mydata.c <- mydata.c %>%
mutate(Delinquency = case_when(
network.delinquency <= .7143 ~ "Non Delinquents", #At or Below the 25th Percentile
(network.delinquency > .7143 & network.delinquency < 1.4286) ~ "Average Teen", #IQR
network.delinquency >= 1.4286 ~ "Delinquents", #At or Above the 75th Percentile
T ~ NA_character_))
(rh.delinquency <- mydata.c %>%
ggplot(aes(x = rh.cat)) +
geom_bar(aes(fill = Delinquency), position = "fill") +
coord_flip() +
labs(title = "Racial Heterogeneity & Delinquency", y = "Proportion of Delinquents", x = " ") +
scale_fill_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5)))
ggsave("rh.delinquency.pdf", rh.delinquency, width = 25, height = 15, units = "cm")
a <- grid.arrange(rh.victim, rh.delinquency, nrow = 2)
ggsave("rh.pdf", a, width = 25, height = 15, units = "cm")
